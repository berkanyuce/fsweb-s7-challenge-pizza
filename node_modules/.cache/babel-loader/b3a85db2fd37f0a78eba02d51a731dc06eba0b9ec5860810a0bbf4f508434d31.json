{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar type_check_utility_1 = require(\"type-check-utility\");\nvar formRegex_1 = __importDefault(require(\"../form/formRegex\"));\nvar constants_1 = __importDefault(require(\"./constants\"));\nfunction isValidChar(e, numberMask) {\n  var key = e === null || e === void 0 ? void 0 : e.key;\n  if (isSpecialCase()) {\n    switch (e.key) {\n      case numberMask.decimalSymbol:\n        if (numberMask.decimalLimit <= 0) return false;\n        break;\n      case constants_1.default.keyboard.hyphen:\n        if (e.target.selectionStart !== 0 || !numberMask.negativeAllowed) return false;\n        break;\n    }\n    return true;\n  }\n  var validChar = formRegex_1.default.number().test(key);\n  if (!validChar) return false;\n  return true;\n  function isSpecialCase() {\n    return key === numberMask.decimalSymbol || key === constants_1.default.keyboard.hyphen;\n  }\n}\nfunction getNegativeSymbol(data, numberMask) {\n  if (type_check_utility_1.isNotDefinedOrEmpty(data)) return '';\n  if (numberMask.negativeAllowed) {\n    if (data.startsWith(constants_1.default.keyboard.hyphen)) return constants_1.default.keyboard.hyphen;\n  }\n  return '';\n}\nfunction extractPureValue(data, numberMask) {\n  if (!type_check_utility_1.isDefined(data)) return data;\n  var result = '';\n  for (var i = 0; i < data.length; i++) {\n    var d = data[i];\n    if (numberMask.decimalLimit > 0 && d === numberMask.decimalSymbol) {\n      result += d;\n      continue;\n    }\n    if (!formRegex_1.default.number().test(d)) continue;\n    result += d;\n  }\n  var negSymbol = getNegativeSymbol(data, numberMask);\n  result = \"\" + negSymbol + result;\n  return result;\n}\nfunction addCommas(value, numberMask) {\n  if (!type_check_utility_1.isNotDefinedOrEmpty(numberMask.prefix)) {\n    if (value.startsWith(numberMask.prefix)) {\n      value = value.substring(numberMask.prefix.length);\n    }\n  }\n  if (!type_check_utility_1.isNotDefinedOrEmpty(numberMask.suffix)) {\n    if (value.endsWith(numberMask.suffix)) {\n      value = value.substring(0, value.length - numberMask.suffix.length);\n    }\n  }\n  if (type_check_utility_1.isNotDefinedOrEmpty(numberMask.thousandsSeparatorSymbol)) {\n    return value;\n  }\n  var negSymbol = getNegativeSymbol(value, numberMask);\n  value = negSymbol + value.replace(/\\D/g, \"\");\n  return value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, numberMask.thousandsSeparatorSymbol);\n}\nfunction replaceDecimalSymbols(value, numberMask) {\n  if (!value.includes(numberMask.decimalSymbol)) return value;\n  var symbol = numberMask.decimalSymbol === '.' ? '\\\\.' : numberMask.decimalSymbol;\n  var gr = new RegExp(symbol, 'g');\n  if (numberMask.decimalLimit <= 0) {\n    return value.replace(gr, '');\n  }\n  var firstSymbolIndex = value.indexOf(numberMask.decimalSymbol) + 1;\n  var replace1 = value.substr(0, firstSymbolIndex);\n  var part2 = value.slice(firstSymbolIndex);\n  var replace2 = part2.replace(gr, '');\n  var resultStr = \"\" + replace1 + replace2;\n  return resultStr;\n}\nfunction toNumberMaskWithCursor(e, numberMask) {\n  var value = e.target.value;\n  var cursorStart = e.target.selectionStart;\n  var cursorEnd = e.target.selectionEnd;\n  if (type_check_utility_1.isNotDefinedOrWhiteSpace(value)) return {\n    value: value,\n    cursorStart: cursorStart,\n    cursorEnd: cursorEnd\n  };\n  value = replaceDecimalSymbols(value, numberMask);\n  var originalLength = value.length;\n  value = addCommasAndRemoveNonDigits(value, numberMask);\n  value = moveNegativeSymbol(value, numberMask);\n  cursorStart = updateCursor(value, cursorStart, originalLength, numberMask);\n  return {\n    value: value,\n    cursorStart: cursorStart,\n    cursorEnd: cursorStart\n  };\n}\nfunction addCommasAndRemoveNonDigits(value, numberMask) {\n  if (!value.includes(numberMask.decimalSymbol)) return addCommas(value, numberMask);\n  var decimalPosition = value.indexOf(numberMask.decimalSymbol);\n  var lhsOfDecimal = value.substring(0, decimalPosition);\n  var rhsOfDecimal = value.substring(decimalPosition + 1);\n  lhsOfDecimal = addCommas(lhsOfDecimal, numberMask);\n  rhsOfDecimal = extractPureValue(rhsOfDecimal, numberMask);\n  rhsOfDecimal = rhsOfDecimal.substring(0, numberMask.decimalLimit);\n  return \"\" + lhsOfDecimal + numberMask.decimalSymbol + rhsOfDecimal;\n}\nfunction updateCursor(value, cursorStart, originalLength, numberMask) {\n  var updatedLength = value.length;\n  cursorStart = updatedLength - originalLength + cursorStart;\n  if (originalLength === 1 && !type_check_utility_1.isNotDefinedOrEmpty(numberMask.suffix)) {\n    cursorStart = cursorStart - numberMask.suffix.length;\n  }\n  return cursorStart;\n}\nfunction moveNegativeSymbol(value, numberMask) {\n  if (type_check_utility_1.isNotDefinedOrEmpty(value)) return value;\n  var negSymbol = getNegativeSymbol(value, numberMask);\n  if (!type_check_utility_1.isNotDefinedOrEmpty(negSymbol)) {\n    value = value.substring(1);\n  }\n  if (value === numberMask.decimalSymbol) {\n    value = \"0\" + value;\n  }\n  return \"\" + negSymbol + numberMask.prefix + value + numberMask.suffix;\n}\nfunction toNumberMask(value, numberMask) {\n  if (type_check_utility_1.isNotDefinedOrEmptyObject(numberMask)) {\n    return {\n      value: value\n    };\n  }\n  var pureValue = extractPureValue(value, numberMask);\n  return {\n    value: addCommas(pureValue, numberMask)\n  };\n}\nfunction updateEventArgs(e, toNumberMaskResult) {\n  e.target.value = toNumberMaskResult.value;\n  e.target.selectionStart = toNumberMaskResult.cursorStart;\n  e.target.selectionEnd = toNumberMaskResult.cursorEnd;\n}\nfunction updateDetail(e, numberMask) {\n  var _a;\n  var value = (_a = e === null || e === void 0 ? void 0 : e.detail) === null || _a === void 0 ? void 0 : _a.value;\n  if (!value) return;\n  var pureValue = extractPureValue(value, numberMask);\n  e.detail.value = pureValue;\n}\nvar numberMaskUtility = {\n  toNumberMaskWithCursor: toNumberMaskWithCursor,\n  updateEventArgs: updateEventArgs,\n  toNumberMask: toNumberMask,\n  updateDetail: updateDetail,\n  extractPureValue: extractPureValue,\n  isValidChar: isValidChar\n};\nexports.default = numberMaskUtility;","map":{"version":3,"names":["type_check_utility_1","require","formRegex_1","__importDefault","constants_1","isValidChar","e","numberMask","key","isSpecialCase","decimalSymbol","decimalLimit","default","keyboard","hyphen","target","selectionStart","negativeAllowed","validChar","number","test","getNegativeSymbol","data","isNotDefinedOrEmpty","startsWith","extractPureValue","isDefined","result","i","length","d","negSymbol","addCommas","value","prefix","substring","suffix","endsWith","thousandsSeparatorSymbol","replace","replaceDecimalSymbols","includes","symbol","gr","RegExp","firstSymbolIndex","indexOf","replace1","substr","part2","slice","replace2","resultStr","toNumberMaskWithCursor","cursorStart","cursorEnd","selectionEnd","isNotDefinedOrWhiteSpace","originalLength","addCommasAndRemoveNonDigits","moveNegativeSymbol","updateCursor","decimalPosition","lhsOfDecimal","rhsOfDecimal","updatedLength","toNumberMask","isNotDefinedOrEmptyObject","pureValue","updateEventArgs","toNumberMaskResult","updateDetail","_a","detail","numberMaskUtility","exports"],"sources":["../../shared/numberMaskUtility.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}