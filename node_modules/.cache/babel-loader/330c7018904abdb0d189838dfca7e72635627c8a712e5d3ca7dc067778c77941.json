{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar react_1 = __importDefault(require(\"react\"));\nvar maskUtility_1 = __importDefault(require(\"../../shared/maskUtility\"));\nvar utility_1 = __importDefault(require(\"../../shared/utility\"));\nvar formUtility_1 = __importDefault(require(\"../formUtility\"));\nvar maskedInput_1 = __importDefault(require(\"./maskedInput\"));\nvar lodash_1 = require(\"lodash\");\nvar SecureMaskedInput = function (_a) {\n  var secure = _a.secure,\n    onChange = _a.onChange,\n    mask = _a.mask,\n    value = _a.value,\n    onFocus = _a.onFocus,\n    onBlur = _a.onBlur,\n    props = __rest(_a, [\"secure\", \"onChange\", \"mask\", \"value\", \"onFocus\", \"onBlur\"]);\n  function getSecureValue(value) {\n    if (!secure || !secure.getValue) return value;\n    value = value || '';\n    var pureValue = maskUtility_1.default.extractPureValue(value, mask);\n    var maskedValue = maskUtility_1.default.toMask(pureValue, mask).value;\n    var detail = {\n      value: maskUtility_1.default.extractPureValue(value, mask),\n      isValid: true,\n      metadata: ['Unknown Validity']\n    };\n    return secure.getValue(detail, maskedValue);\n  }\n  var _b = react_1.default.useState(value),\n    realValue = _b[0],\n    setRealValue = _b[1];\n  var _c = react_1.default.useState(getSecureValue(value)),\n    secureValue = _c[0],\n    setSecureValue = _c[1];\n  var _d = react_1.default.useState(mask),\n    realMask = _d[0],\n    setRealMask = _d[1];\n  var _e = react_1.default.useState([]),\n    secureMask = _e[0],\n    setSecureMask = _e[1];\n  react_1.default.useEffect(function () {\n    if (lodash_1.isEqual(mask, realMask)) return;\n    setRealMask(mask);\n    setSecureValue(getSecureValue(value));\n  }, [mask]);\n  react_1.default.useEffect(function () {\n    if (secureValue === value) return;\n    setSecureValue(getSecureValue(value));\n    var pureValue = maskUtility_1.default.extractPureValue(value, mask);\n    setRealValue(pureValue);\n  }, [value]);\n  function focusEvent(e) {\n    setSecureValue(maskUtility_1.default.toMask(realValue, realMask).value);\n    setSecureMask(realMask);\n    onFocus && onFocus(e);\n  }\n  function blurEvent(e) {\n    setRealValue(maskUtility_1.default.extractPureValue(secureValue, realMask));\n    setSecureValue(getSecureValue(secureValue));\n    setSecureMask([]);\n    onBlur && onBlur(e);\n  }\n  function changeEvent(e) {\n    var maskedValue = maskUtility_1.default.toMask(e.target.value, mask).value;\n    setSecureValue(maskedValue);\n    e.target.value = maskedValue;\n    onChange && onChange(e);\n  }\n  function keyDownEvent(e) {\n    function conditionToOnlyMoveBack(index) {\n      var arr = utility_1.default.strings2FlatArray(maskUtility_1.default.extractConstFromMask(mask));\n      return arr.includes(e.target.value[index]);\n    }\n    formUtility_1.default.backspaceDoNotDelete(e, conditionToOnlyMoveBack);\n  }\n  return react_1.default.createElement(maskedInput_1.default, __assign({\n    mask: secureMask,\n    onChange: changeEvent,\n    onBlur: blurEvent,\n    onFocus: focusEvent,\n    value: secureValue,\n    onKeyDown: keyDownEvent\n  }, props));\n};\nexports.default = SecureMaskedInput;","map":{"version":3,"names":["react_1","__importDefault","require","maskUtility_1","utility_1","formUtility_1","maskedInput_1","lodash_1","SecureMaskedInput","_a","secure","onChange","mask","value","onFocus","onBlur","props","__rest","getSecureValue","getValue","pureValue","default","extractPureValue","maskedValue","toMask","detail","isValid","metadata","_b","useState","realValue","setRealValue","_c","secureValue","setSecureValue","_d","realMask","setRealMask","_e","secureMask","setSecureMask","useEffect","isEqual","focusEvent","e","blurEvent","changeEvent","target","keyDownEvent","conditionToOnlyMoveBack","index","arr","strings2FlatArray","extractConstFromMask","includes","backspaceDoNotDelete","createElement","__assign","onKeyDown","exports"],"sources":["../../../form/controls/secureMaskedInput.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}