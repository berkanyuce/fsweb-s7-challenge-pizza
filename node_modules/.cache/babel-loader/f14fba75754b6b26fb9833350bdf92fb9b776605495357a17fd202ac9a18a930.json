{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar type_check_utility_1 = require(\"type-check-utility\");\nvar utility_1 = __importDefault(require(\"./utility\"));\nfunction extractConstFromMask(mask) {\n  if (type_check_utility_1.isNotDefinedOrEmptyObject(mask)) return [];\n  return mask.filter(function (m) {\n    return !type_check_utility_1.isRegex(m);\n  });\n}\nfunction extractPureValue(data, mask) {\n  if (!type_check_utility_1.isDefined(data) || mask.length === 0) return data;\n  var regexps = mask.filter(function (n) {\n    return type_check_utility_1.isRegex(n);\n  });\n  var result = '';\n  var di = 0;\n  for (var ri = 0; ri < regexps.length && di < data.length; ri++) {\n    var regex = regexps[ri];\n    var val = data[di];\n    if (regex.test(val)) {\n      result += val;\n    } else {\n      ri--;\n    }\n    di++;\n  }\n  return result;\n}\nfunction toMaskWithCursor(e, mask) {\n  var _a = utility_1.default.cursor(e),\n    cursorStart = _a.cursorStart,\n    cursorEnd = _a.cursorEnd;\n  var currentValue = e.target.value;\n  var pureValue = extractPureValue(currentValue, mask) || '';\n  var result = pureValue || '';\n  if (mask.length === 0) {\n    return {\n      value: result,\n      cursorStart: cursorStart,\n      cursorEnd: cursorEnd\n    };\n  }\n  var cursorJump = 0;\n  for (var i = 0; i < result.length; i++) {\n    var m = mask[i];\n    if (m === undefined) break;\n    if (!type_check_utility_1.isRegex(m) && m !== result[i]) {\n      result = utility_1.default.insertAt(result, m, i);\n      if (currentValue[i] !== m && i <= cursorStart) cursorJump = cursorJump + 1;\n    }\n  }\n  return {\n    value: result,\n    cursorStart: cursorStart + cursorJump,\n    cursorEnd: cursorEnd + cursorJump\n  };\n}\nfunction toMask(value, mask) {\n  if (mask.length === 0) {\n    return {\n      value: value\n    };\n  }\n  var currentValue = value;\n  var pureValue = extractPureValue(currentValue, mask);\n  var result = pureValue || '';\n  for (var i = 0; i < result.length; i++) {\n    var m = mask[i];\n    if (m === undefined) break;\n    if (!type_check_utility_1.isRegex(m) && m !== result[i]) {\n      result = utility_1.default.insertAt(result, m, i);\n    }\n  }\n  return {\n    value: result\n  };\n}\nfunction updateEventArgs(e, toMaskResult) {\n  e.target.value = toMaskResult.value;\n  e.target.selectionStart = toMaskResult.cursorStart;\n  e.target.selectionEnd = toMaskResult.cursorEnd;\n}\nfunction updateDetail(e, mask) {\n  var _a;\n  var value = (_a = e === null || e === void 0 ? void 0 : e.detail) === null || _a === void 0 ? void 0 : _a.value;\n  if (!value) return;\n  var pureValue = extractPureValue(value, mask);\n  e.detail.value = pureValue;\n}\nvar maskUtility = {\n  toMaskWithCursor: toMaskWithCursor,\n  updateEventArgs: updateEventArgs,\n  toMask: toMask,\n  updateDetail: updateDetail,\n  extractPureValue: extractPureValue,\n  extractConstFromMask: extractConstFromMask\n};\nexports.default = maskUtility;","map":{"version":3,"names":["type_check_utility_1","require","utility_1","__importDefault","extractConstFromMask","mask","isNotDefinedOrEmptyObject","filter","m","isRegex","extractPureValue","data","isDefined","length","regexps","n","result","di","ri","regex","val","test","toMaskWithCursor","e","_a","default","cursor","cursorStart","cursorEnd","currentValue","target","value","pureValue","cursorJump","i","undefined","insertAt","toMask","updateEventArgs","toMaskResult","selectionStart","selectionEnd","updateDetail","detail","maskUtility","exports"],"sources":["../../shared/maskUtility.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}